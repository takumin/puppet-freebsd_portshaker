# Managed Puppet.
#

<% if @use_zfs -%>
#---[ Using ZFS ]---
use_zfs="yes"
<% end -%>

#---[ Base directory for mirrored Ports Trees ]---
mirror_base_dir="<%= @base_dir %>"

#---[ Directories where to merge ports ]---
ports_trees="<%= @target.keys.join(' ') %>"

<% if defined? @target -%>
<%   @target.each do |name, values| -%>
#---[ <%= name %> Ports Tree ]---
<%     values.each do |key, value| -%>
<%       if key == 'zfs' -%>
<%= name %>_zfs_dataset="<%= value %>"
<%       end -%>
<%       if key == 'tree' -%>
<%= name %>_ports_tree="<%= value %>"
<%       end -%>
<%       if key == 'merge' -%>
<%= name %>_merge_from="<%= value %>"
<%       end -%>
<%       if key == 'preupdate' -%>
<%= name %>_preupdate () {
<%         value.each do |command| -%>
	<%= command %>
<%         end -%>
}
<%       end -%>
<%       if key == 'postupdate' -%>
<%= name %>_postupdate () {
<%         value.each do |command| -%>
	<%= command %>
<%         end -%>
}
<%       end -%>
<%       if key == 'premerge' -%>
<%= name %>_premerge () {
<%         value.each do |command| -%>
	<%= command %>
<%         end -%>
}
<%       end -%>
<%       if key == 'postmerge' -%>
<%= name %>_postmerge () {
<%         value.each do |command| -%>
	<%= command %>
<%         end -%>
}
<%       end -%>
<%     end -%>
<%   end -%>
<% end -%>
